(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{96:function(e,t,n){"use strict";n.r(t);var r,c=n(0),a=n(24),s=n.n(a),i=n(19),o=n(7),u=n.n(o),l=n(10),j=n(11),d=n(20),b=n(8),h=n(18),O=n.n(h),f="/api/users",p=function(){return O.a.get(f).then((function(e){return e.data}))},x=function(e){return O.a.get("".concat(f,"/").concat(e)).then((function(e){return e.data}))},g=n(98),m=n(99),v=n(59),y=n(1),w=function(){var e={padding:10,marginBottom:10,backgroundColor:"#D0E8F2",borderRadius:15,color:"#456268"},t={color:"#456268",fontWeight:"bold",padding:10},n=Object(c.useState)([]),r=Object(j.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){return p().then((function(e){return s(e)}))}),[]),Object(y.jsxs)("div",{className:"container",children:[Object(y.jsx)("h2",{children:"Users"}),Object(y.jsx)(g.a,{children:a.map((function(n){return Object(y.jsxs)(m.a,{style:e,children:[Object(y.jsx)(v.a,{lg:11,children:Object(y.jsx)(d.b,{style:t,to:"/users/".concat(n.id),children:n.username})}),Object(y.jsx)(v.a,{lg:1,children:n.blogs.length})]},n.id)}))})]})},k=n(105),S=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],r=t[1],a=Object(b.f)().id;return Object(c.useEffect)((function(){return x(a).then((function(e){return r(e)})).catch((function(e){return console.log(e)}))}),[a]),n?Object(y.jsxs)("div",{className:"container",children:[Object(y.jsx)("h2",{style:{fontWeight:600},children:n.username}),Object(y.jsx)("h5",{children:"added blogs"}),Object(y.jsx)(k.a,{children:n.blogs.map((function(e){return Object(y.jsx)(k.a.Item,{children:Object(y.jsx)("a",{href:e.url,target:"_blank",children:e.title})},e.id)}))})]}):null},L=n(34),C="/api/blogs",E=function(){return O.a.get(C).then((function(e){return e.data}))},T=function(e){return O.a.get("".concat(C,"/").concat(e)).then((function(e){return e.data}))},N=function(e){var t={headers:{Authorization:r}};return O.a.post(C,e,t).then((function(e){return e.data}))},I=function(e){return O.a.put("".concat(C,"/").concat(e.id),{likes:e.likes+1}).then((function(e){return e.data}))},B=function(e){var t={headers:{Authorization:r}};return O.a.delete("".concat(C,"/").concat(e),t).then((function(e){return e}))},G=function(e){r="Bearer ".concat(e)},_=function(e,t){var n=Object(L.a)({},e);return n.comments=n.comments?n.comments.concat(t):[t],O.a.put("".concat(C,"/").concat(e.id,"/comments"),{comment:t}).then((function(e){return e.data}))},U=n(64),R=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(e);case 2:r=t.sent,n({type:"CREATE_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B(e.id);case 2:n({type:"REMOVE_BLOG",data:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I(e);case 2:r=t.sent,n({type:"UPDATE_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_BLOG":return[].concat(Object(U.a)(e),[t.data]);case"INIT_BLOGS":return t.data;case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));case"UPDATE_BLOG":return e.map((function(e){return e.id===t.data.id?t.data:e}));default:return e}},F=n(106),P=n(100),W=n(101),J=function(){var e=Object(i.b)(),t=Object(b.f)().id,n=Object(c.useState)(null),r=Object(j.a)(n,2),a=r[0],s=r[1],o=Object(c.useState)(""),d=Object(j.a)(o,2),h=d[0],O=d[1];Object(c.useEffect)((function(){T(t).then((function(e){return s(e)}))}),[]);var f=function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e(A(n));case 3:(r=Object(L.a)({},a)).likes++,s(r),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}();return a?Object(y.jsxs)("div",{className:"container",children:[Object(y.jsx)(F.a,{style:{width:"100%"},children:Object(y.jsxs)(F.a.Body,{children:[Object(y.jsx)(F.a.Title,{children:Object(y.jsx)("h2",{children:a.title})}),Object(y.jsx)(F.a.Subtitle,{className:"mb-2 text-muted",children:a.author}),Object(y.jsx)(F.a.Text,{children:Object(y.jsx)("a",{href:a.url,children:a.url})}),Object(y.jsxs)(F.a.Text,{children:["likes ",a.likes,Object(y.jsx)(P.a,{style:{marginLeft:10},size:"sm",onClick:function(){return f(a)},children:"like"})]})]})}),Object(y.jsx)("h5",{style:{marginTop:30},children:"comments"}),Object(y.jsx)(W.a,{style:{marginBottom:10},onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_(e,t);case 2:c=n.sent,r({type:"UPDATE_BLOG",data:c});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(a,h));var n=Object(L.a)({},a);n.comments=n.comments?n.comments.concat(h):[h],s(n),O("")},children:Object(y.jsxs)(W.a.Group,{children:[Object(y.jsx)(W.a.Control,{value:h,onChange:function(e){O(e.target.value)}}),Object(y.jsx)(P.a,{size:"sm",type:"submit",children:"Comment"})]})}),Object(y.jsx)(k.a,{children:a.comments&&a.comments.map((function(e){return Object(y.jsx)(k.a.Item,{children:e},"".concat(a.id,"-").concat(Math.trunc(1e6*Math.random())))}))})]}):null},M=function(e){var t,n=e.blog,r=e.user,a=e.noti;console.log("user: ",r.id,typeof r.id),console.log("blog: ",n.user.id,typeof n.user.id);var s=Object(i.b)(),o=Object(c.useState)(!1),b=Object(j.a)(o,2),h=b[0],O=b[1],f=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s(A(t));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Remove ".concat(t.title," by ").concat(t.author))){e.next=10;break}return e.prev=1,e.next=4,s(z(t));case 4:a("Removed blog ".concat(t.title," successfully.")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a("Failed to remove blog",!1);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)(m.a,{className:"blog",children:Object(y.jsxs)(v.a,{style:{padding:10,marginBottom:10,backgroundColor:"#D0E8F2",borderRadius:15,color:"#456268"},children:[Object(y.jsxs)(m.a,{children:[Object(y.jsx)(v.a,{lg:11,children:Object(y.jsx)(d.b,{style:{color:"#456268",fontWeight:"bold",padding:10},to:"/blogs/".concat(n.id),children:n.title})}),Object(y.jsx)(v.a,{lg:1,children:Object(y.jsx)(P.a,{variant:"primary",size:"sm",onClick:function(){return O(!h)},children:h?"hide":"view"})})]}),h&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(m.a,{children:Object(y.jsx)(v.a,{children:Object(y.jsx)("a",{href:n.url,children:n.url})})}),Object(y.jsxs)(m.a,{children:[Object(y.jsxs)(v.a,{lg:11,children:["likes: ",n.likes]}),Object(y.jsx)(v.a,{lg:1,children:Object(y.jsx)(P.a,{size:"sm",variant:"success",className:"like-btn",onClick:function(){return f(n)},children:"like"})})]}),Object(y.jsx)(m.a,{children:Object(y.jsx)(v.a,{children:n.author})}),Object(y.jsxs)(m.a,{children:[Object(y.jsx)(v.a,{lg:11}),Object(y.jsx)(v.a,{lg:1,children:(r.id===(null===(t=n.user)||void 0===t?void 0:t.id)||r.id===n.user)&&Object(y.jsx)(P.a,{size:"sm",variant:"danger",onClick:function(){return p(n)},children:"delete"})})]})]})]})})},V=function(e){var t=e.createBlog,n=Object(c.useState)(""),r=Object(j.a)(n,2),a=r[0],s=r[1],i=Object(c.useState)(""),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(c.useState)(""),b=Object(j.a)(d,2),h=b[0],O=b[1];return Object(y.jsxs)("div",{className:"container",children:[Object(y.jsx)("h2",{children:"Create a new blog"}),Object(y.jsx)(W.a,{onSubmit:function(e){e.preventDefault(),t({title:a,author:u,url:h}),s(""),l(""),O("")},children:Object(y.jsxs)(W.a.Group,{children:[Object(y.jsx)(W.a.Label,{children:"title:"}),Object(y.jsx)(W.a.Control,{id:"title",type:"text",value:a,name:"Title",onChange:function(e){return s(e.target.value)}}),Object(y.jsx)(W.a.Label,{children:"author:"}),Object(y.jsx)(W.a.Control,{id:"author",type:"text",value:u,name:"Author",onChange:function(e){return l(e.target.value)}}),Object(y.jsx)(W.a.Label,{children:"url:"}),Object(y.jsx)(W.a.Control,{id:"url",type:"text",value:h,name:"url",onChange:function(e){return O(e.target.value)}}),Object(y.jsx)(P.a,{size:"sm",id:"btn-create-blog",type:"submit",children:"create"})]})})]})},H=function(e){var t=e.username,n=e.password,r=e.setUsername,c=e.setPassword,a=e.handleLogin;return Object(y.jsxs)("div",{className:"container",children:[Object(y.jsx)("h2",{children:"Log in to application"}),Object(y.jsx)(W.a,{onSubmit:a,children:Object(y.jsxs)(W.a.Group,{children:[Object(y.jsx)(W.a.Label,{children:"username:"}),Object(y.jsx)(W.a.Control,{id:"username",type:"text",name:"Username",value:t,onChange:function(e){return r(e.target.value)}}),Object(y.jsx)(W.a.Label,{children:"password:"}),Object(y.jsx)(W.a.Control,{id:"password",type:"text",name:"Password",value:n,onChange:function(e){return c(e.target.value)}}),Object(y.jsx)(P.a,{size:"sm",type:"submit",children:"login"})]})})]})},q=Object(c.forwardRef)((function(e,t){var n=Object(c.useState)(!1),r=Object(j.a)(n,2),a=r[0],s=r[1],i=function(){s(!a)},o={margin:20,display:a?"none":""},u={margin:20,display:a?"":"none"};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),Object(y.jsxs)("div",{className:"container",children:[Object(y.jsx)("div",{style:o,children:Object(y.jsx)(P.a,{style:{width:"100%"},onClick:i,children:"create new blog"})}),Object(y.jsxs)("div",{style:u,children:[e.children,Object(y.jsx)(P.a,{style:{marginLeft:15},size:"sm",onClick:i,children:"cancel"})]})]})}));q.displayName="Togglable";var K,Q=q,X=n(103),Y=function(e){var t=e.message,n=e.isSuccess;return Object(y.jsx)("div",{className:"container",children:Object(y.jsx)(X.a,{variant:n?"success":"danger",children:t})})},Z={login:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=O.a.post("/api/login",t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},$=function(e,t){return function(n){clearTimeout(K),n({type:"SET_NOTI",data:{message:e,isSuccess:t}}),K=setTimeout((function(){return n({type:"SET_NOTI",data:{message:null,isSuccess:t}})}),5e3)}},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTI":return t.data;default:return e}},te=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.localStorage.setItem("loggedUserInfo",JSON.stringify(e)),G(e.token),n({type:"USER_LOGIN",data:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGIN":return t.data;case"USER_LOGOUT":return null;default:return e}},re=n(102),ce=n(104),ae=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.blogs})),n=Object(i.c)((function(e){return e.user})),r=Object(i.c)((function(e){return e.notification})),a=Object(c.useState)(""),s=Object(j.a)(a,2),o=s[0],h=s[1],O=Object(c.useState)(""),f=Object(j.a)(O,2),p=f[0],x=f[1],m=Object(c.useRef)();Object(c.useEffect)((function(){return e(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(c.useEffect)((function(){var t=window.localStorage.getItem("loggedUserInfo");if(t){var n=JSON.parse(t);e(te(n))}}),[]);var v=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e($(t,n))},k=function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,m.current.toggleVisibility(),t.next=4,e(R(n));case 4:v("A new blog ".concat(n.title," by ").concat(n.author)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=5,Z.login({username:o,password:p});case 5:r=t.sent,e(te(r)),h(""),x(""),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),v("Wrong username or password",!1);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}(),C=function(e){var t=e.blogs;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(Q,{ref:m,children:Object(y.jsx)(V,{noti:v,createBlog:k})}),Object(y.jsx)(g.a,{children:t&&t.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(y.jsx)(M,{blog:e,user:n,noti:v},e.id)}))})]})},T={padding:"5px"};return Object(y.jsxs)("div",{className:"containter",children:[r.message&&Object(y.jsx)(Y,{message:r.message,isSuccess:r.isSuccess}),null===n?Object(y.jsx)(H,{username:o,password:p,setUsername:h,setPassword:x,handleLogin:L}):Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(d.a,{children:[Object(y.jsx)("div",{children:Object(y.jsxs)(re.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:[Object(y.jsx)(re.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(y.jsx)(re.a.Collapse,{id:"responsive-navbar-nav",children:Object(y.jsxs)(ce.a,{className:"mr-auto",children:[Object(y.jsx)(ce.a.Link,{href:"#",as:"span",children:Object(y.jsx)(d.b,{style:T,to:"/",children:"blogs"})}),Object(y.jsx)(ce.a.Link,{href:"#",as:"span",children:Object(y.jsx)(d.b,{style:T,to:"/users",children:"users"})}),Object(y.jsxs)(ce.a.Link,{href:"#",as:"span",children:["".concat(n.username," logged in"),Object(y.jsx)(P.a,{size:"sm",onClick:function(){e(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedUserInfo"),G(void 0),t({type:"USER_LOGOUT"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v("Logged out successfully!")},children:"logout"})]})]})})]})}),Object(y.jsx)("h2",{style:{color:"#456268",textAlign:"center",fontWeight:900,paddingTop:30},children:"BLOGS"}),Object(y.jsxs)(b.c,{children:[Object(y.jsx)(b.a,{path:"/users/:id",children:Object(y.jsx)(S,{})}),Object(y.jsx)(b.a,{path:"/blogs/:id",children:Object(y.jsx)(J,{})}),Object(y.jsx)(b.a,{path:"/users",children:Object(y.jsx)(w,{})}),Object(y.jsx)(b.a,{path:"/",children:Object(y.jsx)(C,{blogs:t})})]})]})})]})},se=n(45),ie=n(63),oe=Object(se.b)({notification:ee,blogs:D,user:ne}),ue=Object(se.c)(oe,Object(se.a)(ie.a));s.a.render(Object(y.jsx)(i.a,{store:ue,children:Object(y.jsx)(ae,{})}),document.getElementById("root"))}},[[96,1,2]]]);
//# sourceMappingURL=main.93bfa797.chunk.js.map